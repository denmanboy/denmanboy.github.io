---
title: 模仿微信更改头像，图片局部放大
toc: true
tags: iOS
categories: technology
date: 2015-03-06 19:41:08
description: 模仿微信更改头像，图片局部放大
---
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>

## 代码

```objc
#import "ViewController.h"

@interface ViewController (){
    UIImageView *showImageView;
    UIImageView *imageView;
  }
@end

@implementation ViewController

- (void)viewDidLoad {
    [superviewDidLoad];
    self.view.backgroundColor = [UIColorgrayColor];
    //女孩图片
    imageView = [[UIImageViewalloc]initWithFrame:CGRectMake(70, 50,241, 360)];
    //  imageView.layer.contents = (__bridge id)([UIImage imageNamed:@"图片0.jpg"].CGImage);
    imageView.image = [UIImageimageNamed:@"图片0.jpg"];
    imageView.alpha =0.4;    
    imageView.userInteractionEnabled =YES;
    [self.viewaddSubview:imageView];
    
    //显示放大的局部图片
    UIImageView *screenShotView = [[UIImageViewalloc]initWithFrame:CGRectMake(0,0, 80,80)];
    //screenShotView.backgroundColor = [UIColor yellowColor];
    screenShotView.backgroundColor = [UIColorclearColor];
    screenShotView.userInteractionEnabled =YES;
    screenShotView.layer.borderColor = [UIColorredColor].CGColor;
    screenShotView.layer.borderWidth =1.0f;
    [imageViewaddSubview:screenShotView];
    // 手势拖动
    UIPanGestureRecognizer *panGesture = [[UIPanGestureRecognizeralloc]initWithTarget:self action:@selector(panGestureRecognizer:)];
    [screenShotView addGestureRecognizer:panGesture];
     showImageView = [[UIImageViewalloc]initWithFrame:CGRectMake(100,440, 190,190)];
    showImageView.backgroundColor = [UIColorredColor];
    [self.viewaddSubview:showImageView];
    // Do any additional setup after loading the view, typically from a nib.

}

//移动手势的回调方法
- (void)panGestureRecognizer:(UIPanGestureRecognizer*)panGesture{
    CGPoint point = [panGesturelocationInView:imageView];
    panGesture.view.center =  point;
    CGRect rect = panGesture.view.frame;
    UIImage *newImage = [selfInterceptionUIImageWithImage: imageView.image andRect:rect];
    showImageView.image = newImage;
    // ((UIImageView*)panGesture.view).image = newImage;
}
//截取图片的某一部分
- (UIImage*)InterceptionUIImageWithImage:(UIImage*)image andRect:(CGRect)rect{
    CGImageRef imageRef = image.CGImage;
    CGImageRef imageRefRect =CGImageCreateWithImageInRect(imageRef, rect);
    UIImage *imageRect = [[UIImagealloc] initWithCGImage:imageRefRect];
    return imageRect;   
}
- (void)didReceiveMemoryWarning {
    [superdidReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}
```

## 效果
 <img src="https://cl.ly/450m0U0Y1R1t/20150306192346262.png"  alt="图片名称" align=center />

  <img src="https://cl.ly/1H3O0G1g462C/20150306192304828.png" alt="图片名称" align=center />












